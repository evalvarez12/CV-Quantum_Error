function [F] = fid_tmsv_gen_loss_gs(V, g, sigma, T1r, T2r, T3r, epsilon)
warning('off')

switch g
    case 0
        F=...
        integralN(@(r,theta,ra,ri)...
        exp(-(ra.^2 + ri.^2)./sigma).*1/(pi*sigma).*...
        (exp(1).^((-1/16).*r.*(r.*(8+4.*epsilon+T2r+(-2).*T3r+T1r.*((-1)+V) ...
  +(-2).*T1r.^(1/2).*T2r.^(1/2).*((-1)+V)+T2r.*V)+(sqrt(-1)*8).*2.^( ...
  1/2).*ri.*((-2)+T1r.^(1/2)+T2r.^(1/2)).*cos(theta)+(sqrt(-1)*(-8)) ...
  .*2.^(1/2).*ra.*((-2)+T1r.^(1/2)+T2r.^(1/2)).*sin(theta))).*pi.^( ...
  -1).*r)...
        ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma);


    case 1
        F=...
        integralN(@(r,theta,ra,ri)...
        exp(-(ra.^2 + ri.^2)./sigma).*1/(pi*sigma).*...
        (exp(1).^((-1/4).*r.*(r.*(4+3.*epsilon+(-1).*T3r+T1r.*((-1)+V)+ ...
T3r.*V+(-2).*T1r.^(1/2).*T3r.^(1/2).*((-1)+V.^2).^(1/2))+(sqrt(-1) ...
  *4).*2.^(1/2).*ri.*((-1)+T1r.^(1/2)).*cos(theta)+(sqrt(-1)*(-4)).* ...
  2.^(1/2).*ra.*((-1)+T1r.^(1/2)).*sin(theta))).*pi.^(-1).*r)...
        ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma);


    case -1
        F=...
        integralN(@(r,theta,ra,ri)...
        exp(-(ra.^2 + ri.^2)./sigma).*1/(pi*sigma).*...
        (exp(1).^((-1/4).*r.*(r.*(4+3.*epsilon+T2r+(-3).*T3r+T2r.*V+T3r.*V+ ...
  (-2).*T2r.^(1/2).*T3r.^(1/2).*((-1)+V.^2).^(1/2))+(sqrt(-1)*4).* ...
  2.^(1/2).*ri.*((-1)+T2r.^(1/2)).*cos(theta)+(sqrt(-1)*(-4)).*2.^( ...
  1/2).*ra.*((-1)+T2r.^(1/2)).*sin(theta))).*pi.^(-1).*r)...
        ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma);

end
F = real(F);

end