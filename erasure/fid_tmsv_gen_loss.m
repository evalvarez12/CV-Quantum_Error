function [F] = fid_tmsv_gen_loss(V, g, sigma, T1r, T2r, T3r, epsilon)
gx = g;
gp = g;

warning('off')
F=...
integralN(@(r,theta,ra,ri)...
exp(-(ra.^2 + ri.^2)./sigma).*1/(pi*sigma).*...
(exp(1).^((-1/16).*r.*(4.*r.*cos(theta).^2+2.*(1+gx).^2.*r.*(1+ ...
epsilon+(-1).*T1r.^2).*cos(theta).^2+r.*((1+gx).*T1r.^(1/2)+(-1).* ...
  ((-1)+gx).*T2r.^(1/2)).^2.*cos(theta).^2+2.*((-1)+gx).^2.*r.*(1+ ...
  epsilon+(-1).*T3r.^2).*cos(theta).^2+4.*gx.^2.*r.*(1+epsilon+(-1) ...
  .*T3r.^2).*cos(theta).^2+4.*r.*sin(theta).^2+2.*(1+gp).^2.*r.*(1+ ...
  epsilon+(-1).*T1r.^2).*sin(theta).^2+r.*((1+gp).*T1r.^(1/2)+(-1).* ...
  ((-1)+gp).*T2r.^(1/2)).^2.*sin(theta).^2+2.*((-1)+gp).^2.*r.*(1+ ...
  epsilon+(-1).*T3r.^2).*sin(theta).^2+4.*gp.^2.*r.*(1+epsilon+(-1) ...
  .*T3r.^2).*sin(theta).^2+(sqrt(-1)*(-16)).*2.^(1/2).*(ri.*cos( ...
 theta)+(-1).*ra.*sin(theta))+(sqrt(-1)*8).*2.^(1/2).*(ri.*((1+gx) ...
  .*T1r.^(1/2)+(-1).*((-1)+gx).*T2r.^(1/2)).*cos(theta)+(-1).*ra.*(( ...
  1+gp).*T1r.^(1/2)+(-1).*((-1)+gp).*T2r.^(1/2)).*sin(theta))+(-4).* ...
  r.*T3r.^(1/2).*((-1)+V.^2).^(1/2).*(gx.*((1+gx).*T1r.^(1/2)+((-1)+ ...
  gx).*T2r.^(1/2)).*cos(theta).^2+gp.*((1+gp).*T1r.^(1/2)+((-1)+gp) ...
  .*T2r.^(1/2)).*sin(theta).^2)+r.*V.*(((1+gx).*T1r.^(1/2)+((-1)+gx) ...
  .*T2r.^(1/2)).^2.*cos(theta).^2+4.*gx.^2.*T3r.*cos(theta).^2+((1+ ...
  gp).*T1r.^(1/2)+((-1)+gp).*T2r.^(1/2)).^2.*sin(theta).^2+4.* ...
gp.^2.*T3r.*sin(theta).^2))).*pi.^(-1).*r)...
,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma);


F = real(F);

end