function [F] = fid_tmsv_gen_loss(V, g, sigma, T1r, T2r, T3r, epsilon)
gx = g;
gp = g;

warning('off')
F=...
integralN(@(r,theta,ra,ri)...
exp(-(ra.^2 + ri.^2)./sigma).*1/(pi*sigma).*...
(exp(1).^((-1/8).*r.*((sqrt(-1)*8).*ri.*((-2)+(1+gx).*T1r.^(1/2)+( ...
-1).*((-1)+gx).*T2r.^(1/2)).*cos(theta)+r.*(8+epsilon.*(4+8.* ...
gx.^2)+(-1).*T1r+2.*T1r.^(1/2).*T2r.^(1/2)+T2r+(-2).*T3r+T1r.*V+( ...
-2).*T1r.^(1/2).*T2r.^(1/2).*V+T2r.*V+(-2).*gx.*(T1r+T2r+(-2).* ...
T3r+(-1).*T1r.*V+T2r.*V+2.*T1r.^(1/2).*T3r.^(1/2).*((-1)+V.^2).^( ...
1/2)+(-2).*T2r.^(1/2).*T3r.^(1/2).*((-1)+V.^2).^(1/2))+gx.^2.*(8+ ...
T2r+(-6).*T3r+T1r.*((-1)+V)+T2r.*V+4.*T3r.*V+(-4).*T2r.^(1/2).* ...
T3r.^(1/2).*((-1)+V.^2).^(1/2)+2.*T1r.^(1/2).*(T2r.^(1/2).*((-1)+ ...
V)+(-2).*T3r.^(1/2).*((-1)+V.^2).^(1/2)))).*cos(theta).^2+sin( ...
theta).*((sqrt(-1)*(-8)).*ra.*((-2)+(1+gp).*T1r.^(1/2)+(-1).*((-1) ...
+gp).*T2r.^(1/2))+r.*(8+epsilon.*(4+8.*gp.^2)+(-1).*T1r+2.*T1r.^( ...
1/2).*T2r.^(1/2)+T2r+(-2).*T3r+T1r.*V+(-2).*T1r.^(1/2).*T2r.^(1/2) ...
.*V+T2r.*V+(-2).*gp.*(T1r+T2r+(-2).*T3r+(-1).*T1r.*V+T2r.*V+2.* ...
T1r.^(1/2).*T3r.^(1/2).*((-1)+V.^2).^(1/2)+(-2).*T2r.^(1/2).* ...
T3r.^(1/2).*((-1)+V.^2).^(1/2))+gp.^2.*(8+T2r+(-6).*T3r+T1r.*((-1) ...
+V)+T2r.*V+4.*T3r.*V+(-4).*T2r.^(1/2).*T3r.^(1/2).*((-1)+V.^2).^( ...
1/2)+2.*T1r.^(1/2).*(T2r.^(1/2).*((-1)+V)+(-2).*T3r.^(1/2).*((-1)+ ...
V.^2).^(1/2)))).*sin(theta)))).*pi.^(-1).*r)...
,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma);


F = real(F);

end