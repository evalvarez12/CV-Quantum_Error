function [F] = f_code_sb(T1, T2, T3, V, d, g, sigma)
warning('off')
rs = acosh(V)/2;


    F=...
        integralN(@(r,theta,ra,ri)...
        exp(-(ra.^2 + ri.^2)./sigma).*1/(pi*sigma).*...
        (exp(1).^((1/8).*r.*((-4).*r+(-8).*exp(1).^(sqrt(-1).*theta).*(ra+( ...
  sqrt(-1)*(-1)).*ri)+8.*exp(1).^((sqrt(-1)*(-1)).*theta).*(ra+sqrt( ...
  -1).*ri)+4.*exp(1).^(sqrt(-1).*theta).*(ra+(sqrt(-1)*(-1)).*ri).*( ...
  T1+g.*T1+T2+(-1).*g.*T2)+(-4).*exp(1).^((sqrt(-1)*(-1)).*theta).*( ...
  ra+sqrt(-1).*ri).*(T1+g.*T1+T2+(-1).*g.*T2)+(-1).*r.*(T1+g.*T1+T2+ ...
  (-1).*g.*T2).^2+2.*r.*((-2)+T1.^2+T2.^2+2.*g.*(T1.^2+(-1).*T2.^2)+ ...
  g.^2.*((-4)+T1.^2+T2.^2+2.*T3.^2))+(-4).*r.*((1/4).*((1+g).*T1+(( ...
  -1)+g).*T2).^2+g.^2.*T3.^2).*cosh(2.*rs)+4.*g.*r.*((1+g).*T1+((-1) ...
  +g).*T2).*T3.*sinh(2.*rs))).*pi.^(-1).*r.*(cos(d).^2+(1/16).*sin( ...
  d).^2.*((-4)+4.*g.^2.*r.^2.*T3.^2.*cosh(rs).^2+r.^2.*((1+g).*T1+(( ...
  -1)+g).*T2).^2.*sinh(rs).^2+(-2).*g.*r.^2.*((1+g).*T1+((-1)+g).* ...
  T2).*T3.*sinh(2.*rs)).*((-4)+r.^2.*((1+g).*T1+((-1)+g).*T2).^2.* ...
  cosh(rs).^2+4.*g.^2.*r.^2.*T3.^2.*sinh(rs).^2+(-2).*g.*r.^2.*((1+ ...
  g).*T1+((-1)+g).*T2).*T3.*sinh(2.*rs))+(1/2).*r.^2.*sin(2.*d).*( ...
  g.*((1+g).*T1+((-1)+g).*T2).*T3.*cosh(2.*rs)+(-1).*((1/4).*((1+g) ...
  .*T1+((-1)+g).*T2).^2+g.^2.*T3.^2).*sinh(2.*rs))))...
        ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma);


F = real(F);

end