function [F] = prob_dist_pspa(xbar, pbar, da, di, T1, T2, T3, V, T, sigma, mode)
warning('off')

switch mode
    case 2
        F=...
            integralN(@(r,theta,ra,ri)...
            exp(-(ra.^2 + ri.^2)./sigma).*1/(4*pi^3*sigma).*...
            ((-1/8).*exp(1).^((-1/16).*r.*((-2).*r.*((-1)+T1.^2)+(-4).*2.^(1/2) ...
      .*exp(1).^(sqrt(-1).*theta).*(ra+(sqrt(-1)*(-1)).*ri).*(T1+(-1).* ...
      T2)+4.*2.^(1/2).*exp(1).^((sqrt(-1)*(-1)).*theta).*(ra+sqrt(-1).* ...
      ri).*(T1+(-1).*T2)+r.*(T1+(-1).*T2).^2+4.*2.^(1/2).*(da+sqrt(-1).* ...
      di).*exp(1).^((sqrt(-1)*(-1)).*theta).*(T1+T2)+(-4).*2.^(1/2).*( ...
      da+(sqrt(-1)*(-1)).*di).*exp(1).^(sqrt(-1).*theta).*(T1+T2)+(-2).* ...
      r.*((-1)+T2.^2)+(-4).*r.*((-1)+T3.^2)+r.*(T1+T2).^2.*(1+T+R.*V).^( ...
      -1).*(R+V+T.*V)+4.*r.*T3.^2.*(1+T+R.*V).^(-1).*(R+V+T.*V)+(-8).* ...
      r.*(T1+T2).*T3.*(1+T+R.*V).^(-1).*(T.*((-1)+V.^2)).^(1/2)+(sqrt( ...
      -1)*16).*exp(1).^(sqrt(-1).*theta).*(pbar+sqrt(-1).*xbar)+16.*exp( ...
      1).^((sqrt(-1)*(-1)).*theta).*(sqrt(-1).*pbar+xbar))).*((-1)+R+( ...
      -1).*T).^(-1).*((-1)+V).^(-1).*(1+T+R.*V).^(-2).*(R+V+T.*V).^(-1) ...
      .*(8.*(1+(-1).*R+T).^2.*((-1)+V).^2.*(1+T+R.*V).^2+(-8).*((-1)+R+( ...
      -1).*T).*((-1)+V).*(1+T+R.*V).^3+4.*r.^2.*((-1)+R+(-1).*T).*((-1)+ ...
      V).*(1+T+R.*V).*(((-1)+R+(-1).*T).*T3.*((-1)+V)+(T1+T2).*(T.*((-1) ...
      +V.^2)).^(1/2)).^2+(-2).*r.^2.*(1+T+R.*V).^2.*(((-1)+R+(-1).*T).* ...
      T3.*((-1)+V)+(T1+T2).*(T.*((-1)+V.^2)).^(1/2)).^2+(1/4).*r.^4.*((( ...
      -1)+R+(-1).*T).*T3.*((-1)+V)+(T1+T2).*(T.*((-1)+V.^2)).^(1/2)).^4+ ...
      r.^2.*T3.^2.*(1+T+R.*V).^2.*(r.^2.*(1+(-1).*R+T).^2.*T3.^2.*((-1)+ ...
      V).^2+4.*((-1)+R+(-1).*T).*((-1)+V).*(1+T+R.*V)+r.^2.*T.*(T1+T2) ...
      .^2.*((-1)+V.^2)+(-2).*r.^2.*(1+(-1).*R+T).*(T1+T2).*T3.*((-1)+V) ...
      .*(T.*((-1)+V.^2)).^(1/2))+(-1).*r.^2.*T3.*(1+T+R.*V).*(((-1)+R+( ...
      -1).*T).*T3.*((-1)+V)+(T1+T2).*(T.*((-1)+V.^2)).^(1/2)).*(r.^2.*( ...
      1+(-1).*R+T).^2.*T3.^2.*((-1)+V).^2+8.*((-1)+R+(-1).*T).*((-1)+V) ...
      .*(1+T+R.*V)+r.^2.*T.*(T1+T2).^2.*((-1)+V.^2)+(-2).*r.^2.*(1+(-1) ...
      .*R+T).*(T1+T2).*T3.*((-1)+V).*(T.*((-1)+V.^2)).^(1/2))))...
            ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma,'AbsTol',1e-3,'RelTol',1e-3);
    case 3
        F=...
            integralN(@(r,theta,ra,ri)...
            exp(-(ra.^2 + ri.^2)./sigma).*1/(4*pi^3*sigma).*...
            ((-1/8).*exp(1).^((-1/16).*r.*((-2).*r.*((-1)+T1.^2)+(-4).*2.^(1/2) ...
          .*exp(1).^(sqrt(-1).*theta).*(ra+(sqrt(-1)*(-1)).*ri).*(T1+(-1).* ...
          T2)+4.*2.^(1/2).*exp(1).^((sqrt(-1)*(-1)).*theta).*(ra+sqrt(-1).* ...
          ri).*(T1+(-1).*T2)+r.*(T1+(-1).*T2).^2+4.*2.^(1/2).*(da+sqrt(-1).* ...
          di).*exp(1).^((sqrt(-1)*(-1)).*theta).*(T1+T2)+(-4).*2.^(1/2).*( ...
          da+(sqrt(-1)*(-1)).*di).*exp(1).^(sqrt(-1).*theta).*(T1+T2)+(-2).* ...
          r.*((-1)+T2.^2)+(-4).*r.*((-1)+T3.^2)+r.*(T1+T2).^2.*(1+T+R.*V).^( ...
          -1).*(R+V+T.*V)+4.*r.*T3.^2.*(1+T+R.*V).^(-1).*(R+V+T.*V)+(-8).* ...
          r.*(T1+T2).*T3.*(1+T+R.*V).^(-1).*(T.*((-1)+V.^2)).^(1/2)+(sqrt( ...
          -1)*16).*exp(1).^(sqrt(-1).*theta).*(pbar+sqrt(-1).*xbar)+16.*exp( ...
          1).^((sqrt(-1)*(-1)).*theta).*(sqrt(-1).*pbar+xbar))).*((-1)+R+( ...
          -1).*T).^(-1).*((-1)+V).^(-1).*(1+T+R.*V).^(-2).*(R+V+T.*V).^(-1) ...
          .*(8.*(1+(-1).*R+T).^2.*((-1)+V).^2.*(1+T+R.*V).^2+(-8).*((-1)+R+( ...
          -1).*T).*((-1)+V).*(1+T+R.*V).^3+r.^2.*((-1)+R+(-1).*T).*((-1)+V) ...
          .*(1+T+R.*V).*(((-1)+R+(-1).*T).*T1.*((-1)+V)+((-1)+R+(-1).*T).* ...
          T2.*((-1)+V)+4.*T3.*(T.*((-1)+V.^2)).^(1/2)).^2+(-1/2).*r.^2.*(1+ ...
          T+R.*V).^2.*(((-1)+R+(-1).*T).*T1.*((-1)+V)+((-1)+R+(-1).*T).*T2.* ...
          ((-1)+V)+4.*T3.*(T.*((-1)+V.^2)).^(1/2)).^2+(1/64).*r.^4.*(((-1)+ ...
          R+(-1).*T).*T1.*((-1)+V)+((-1)+R+(-1).*T).*T2.*((-1)+V)+4.*T3.*( ...
          T.*((-1)+V.^2)).^(1/2)).^4+(1/2).*r.^2.*(T1+T2).^2.*(1+T+R.*V) ...
          .^2.*((1/8).*r.^2.*(1+(-1).*R+T).^2.*(T1+T2).^2.*((-1)+V).^2+2.*(( ...
          -1)+R+(-1).*T).*((-1)+V).*(1+T+R.*V)+2.*r.^2.*T.*T3.^2.*((-1)+ ...
          V.^2)+r.^2.*((-1)+R+(-1).*T).*(T1+T2).*T3.*((-1)+V).*(T.*((-1)+ ...
          V.^2)).^(1/2))+(-1/2).*r.^2.*(T1+T2).*(1+T+R.*V).*(((-1)+R+(-1).* ...
          T).*(T1+T2).*((-1)+V)+4.*T3.*(T.*((-1)+V.^2)).^(1/2)).*((1/8).* ...
          r.^2.*(1+(-1).*R+T).^2.*(T1+T2).^2.*((-1)+V).^2+4.*((-1)+R+(-1).* ...
          T).*((-1)+V).*(1+T+R.*V)+2.*r.^2.*T.*T3.^2.*((-1)+V.^2)+r.^2.*(( ...
          -1)+R+(-1).*T).*(T1+T2).*T3.*((-1)+V).*(T.*((-1)+V.^2)).^(1/2))))...
            ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma,'AbsTol',1e-3,'RelTol',1e-3);


F = real(F);

end