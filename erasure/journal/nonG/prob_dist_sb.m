function [F] = prob_dist_sb(xbar, pbar, da, di, T1, T2, T3, V, d, sigma)
warning('off')
rs = acosh(V)/2;


    F=...
        integralN(@(r,theta,ra,ri)...
        exp(-(ra.^2 + ri.^2)./sigma).*1/(4*pi^3*sigma).*...
        (exp(1).^((1/16).*r.*(2.*r.*((-1)+T1.^2)+4.*2.^(1/2).*exp(1).^( ...
  sqrt(-1).*theta).*(ra+(sqrt(-1)*(-1)).*ri).*(T1+(-1).*T2)+(-4).* ...
  2.^(1/2).*exp(1).^((sqrt(-1)*(-1)).*theta).*(ra+sqrt(-1).*ri).*( ...
  T1+(-1).*T2)+(-1).*r.*(T1+(-1).*T2).^2+(-4).*2.^(1/2).*(da+sqrt( ...
  -1).*di).*exp(1).^((sqrt(-1)*(-1)).*theta).*(T1+T2)+4.*2.^(1/2).*( ...
  da+(sqrt(-1)*(-1)).*di).*exp(1).^(sqrt(-1).*theta).*(T1+T2)+2.*r.* ...
  ((-1)+T2.^2)+4.*r.*((-1)+T3.^2)+16.*exp(1).^(sqrt(-1).*theta).*(( ...
  sqrt(-1)*(-1)).*pbar+xbar)+(-16).*exp(1).^((sqrt(-1)*(-1)).*theta) ...
  .*(sqrt(-1).*pbar+xbar)+(-1).*r.*(T1.^2+2.*T1.*T2+T2.^2+4.*T3.^2) ...
  .*cosh(2.*rs)+4.*r.*(T1+T2).*T3.*sinh(2.*rs))).*(cos(d).^2+(1/64) ...
  .*sin(d).^2.*((-8)+4.*r.^2.*T3.^2.*cosh(rs).^2+r.^2.*(T1+T2).^2.* ...
  sinh(rs).^2+(-2).*r.^2.*(T1+T2).*T3.*sinh(2.*rs)).*((-8)+r.^2.*( ...
  T1+T2).^2.*cosh(rs).^2+4.*r.^2.*T3.^2.*sinh(rs).^2+(-2).*r.^2.*( ...
  T1+T2).*T3.*sinh(2.*rs))+(-1/16).*r.^2.*sin(2.*d).*((-4).*(T1+T2) ...
  .*T3.*cosh(2.*rs)+(T1.^2+2.*T1.*T2+T2.^2+4.*T3.^2).*sinh(2.*rs))))...
        ,0,inf,0,2*pi,-3*sigma,3*sigma,-3*sigma,3*sigma,'AbsTol',1e-3,'RelTol',1e-3);


F = real(F);

end